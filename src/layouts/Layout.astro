---
import { ClientRouter } from "astro:transitions";

interface Props {
	title: string;
	description?: string;
}

const { title, description = "Henry Percy's Blogfolio" } = Astro.props;
const path = Astro.url.pathname;
const fistPathVar = path.split('/').filter(Boolean)[0];
---

<!doctype html>
<html lang="en" class="dark" data-theme="vitesse-dark">
	<head>
		<meta charset="UTF-8" />
		<meta name="description" content={description} />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="generator" content={Astro.generator} />
		<title>{title}</title>
		<ClientRouter />
	</head>
	<body class="transition-all bg-white dark:bg-black max-w-3xl mx-auto container">
		<header class="py-14 md:pb-20 text-stone-700 dark:text-stone-200">
			<nav class="flex justify-between">
				<ul class="flex gap-x-4">
					<li><a class="hover:text-stone-950 hover:dark:text-stone-50" href="/">home</a>{path === '/' && <div transition:name="nav-underline" class="h-px w-full bg-stone-300 dark:bg-stone-700"></div>}</li>
					<li><a class="hover:text-stone-950 hover:dark:text-stone-50" href="/posts">posts</a>{fistPathVar === 'posts' && <div transition:name="nav-underline" class="h-px w-full bg-stone-300 dark:bg-stone-700"></div>}</li>
					<li><a class="hover:text-stone-950 hover:dark:text-stone-50" href="/spanish">spanish</a>{fistPathVar === 'spanish' && <div transition:name="nav-underline" class="h-px w-full bg-stone-300 dark:bg-stone-700"></div>}</li>
					<li><a class="hover:text-stone-950 hover:dark:text-stone-50" href="/books">reading</a>{fistPathVar === 'books' && <div transition:name="nav-underline" class="h-px w-full bg-stone-300 dark:bg-stone-700"></div>}</li>
				</ul>
				<button id="theme-toggle">
					<svg id="dark-theme-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path class="fill-white" d="M12 21q-3.775 0-6.388-2.613T3 12q0-3.45 2.25-5.988T11 3.05q.325-.05.575.088t.4.362q.15.225.163.525t-.188.575q-.425.65-.638 1.375T11.1 7.5q0 2.25 1.575 3.825T16.5 12.9q.775 0 1.538-.225t1.362-.625q.275-.175.563-.162t.512.137q.25.125.388.375t.087.6q-.35 3.45-2.938 5.725T12 21Zm0-2q2.2 0 3.95-1.213t2.55-3.162q-.5.125-1 .2t-1 .075q-3.075 0-5.238-2.163T9.1 7.5q0-.5.075-1t.2-1q-1.95.8-3.163 2.55T5 12q0 2.9 2.05 4.95T12 19Zm-.25-6.75Z"/></svg>
					<svg id="light-theme-icon" class="hidden" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path class="fill-black" d="M11 5V1h2v4h-2Zm6.65 2.75l-1.375-1.375l2.8-2.875l1.4 1.425L17.65 7.75ZM19 13v-2h4v2h-4Zm-8 10v-4h2v4h-2ZM6.35 7.7L3.5 4.925l1.425-1.4L7.75 6.35L6.35 7.7Zm12.7 12.8l-2.775-2.875l1.35-1.35l2.85 2.75L19.05 20.5ZM1 13v-2h4v2H1Zm3.925 7.5l-1.4-1.425l2.8-2.8l.725.675l.725.7l-2.85 2.85ZM12 18q-2.5 0-4.25-1.75T6 12q0-2.5 1.75-4.25T12 6q2.5 0 4.25 1.75T18 12q0 2.5-1.75 4.25T12 18Zm0-2q1.65 0 2.825-1.175T16 12q0-1.65-1.175-2.825T12 8q-1.65 0-2.825 1.175T8 12q0 1.65 1.175 2.825T12 16Zm0-4Z"/></svg>
				</button>
			</nav>
		</header>
		<slot />
	</body>
	<footer class="mt-20 mb-14 md:mb-44">
		<div class="space-y-5">
			{path !== '/' && <p class="flex gap-x-1 items-center mb-10"><svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 24 24"><path class="fill-stone-400 dark:fill-stone-500" d="M10 6L8.59 7.41L13.17 12l-4.58 4.59L10 18l6-6z"/></svg><a class="text-stone-400 dark:text-stone-500 border-b border-b-stone-200 dark:border-b-stone-800 transition-colors duration-500 hover:border-b-stone-400 hover:dark:border-b-stone-500" href="/">cd ~</a></p>}
			<div class="flex gap-x-1.5">
				<a class="transition-transform hover:scale-110 hover:rotate-6 group" href="https://github.com/henryppercy" target="_blank">
					<svg class="group-hover:[&_path]:fill-stone-900 group-hover:[&_path]:dark:fill-stone-50" xmlns="http://www.w3.org/2000/svg" width=20 height=20 viewBox="0 0 24 24">
						<path class="transition-colors fill-stone-600 dark:fill-stone-300" d="M5 3h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4.44c-.32-.07-.33-.68-.33-.89l.01-2.47c0-.84-.29-1.39-.61-1.67c2.01-.22 4.11-.97 4.11-4.44c0-.98-.35-1.79-.92-2.42c.09-.22.4-1.14-.09-2.38c0 0-.76-.23-2.48.93c-.72-.2-1.48-.3-2.25-.31c-.76.01-1.54.11-2.25.31c-1.72-1.16-2.48-.93-2.48-.93c-.49 1.24-.18 2.16-.09 2.38c-.57.63-.92 1.44-.92 2.42c0 3.47 2.1 4.22 4.1 4.47c-.26.2-.49.6-.57 1.18c-.52.23-1.82.63-2.62-.75c0 0-.48-.86-1.38-.93c0 0-.88 0-.06.55c0 0 .59.28 1 1.32c0 0 .52 1.75 3.03 1.21l.01 1.53c0 .21-.02.82-.34.89H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z" />
					</svg>
				</a>
				<a class="transition-transform hover:scale-110 hover:-rotate-6 group" href="https://www.linkedin.com/in/henry-b-percy/" target="_blank">
					<svg class="group-hover:[&_path]:fill-stone-900 group-hover:[&_path]:dark:fill-stone-50" xmlns="http://www.w3.org/2000/svg" width=20 height=20 viewBox="0 0 24 24">
						<path class="fill-stone-600 dark:fill-stone-300" d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14m-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4a1.4 1.4 0 0 1 1.4 1.4v4.93h2.79M6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-8.37H5.5v8.37h2.77Z"/>
					</svg>
				</a>
				<a class="transition-transform hover:scale-110 hover:rotate-6 group" href="mailto:henrypercydev@gmail.com" target="_blank">
					<svg class="group-hover:[&_path]:fill-stone-900 group-hover:[&_path]:dark:fill-stone-50" xmlns="http://www.w3.org/2000/svg"  width=20 height=20 viewBox="0 0 24 24">
						<path class="fill-stone-600 dark:fill-stone-300" d="m20 8l-8 5l-8-5V6l8 5l8-5m0-2H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2Z"/>
					</svg>
				</a>
			</div>
			<div class="flex gap-x-2 text-sm text-stone-400 dark:text-stone-500">
				<a class="border-b border-b-stone-200 dark:border-b-stone-800 transition-colors duration-500 hover:border-b-stone-400 hover:dark:border-b-stone-500" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a>
				<p class="flex items-center gap-x-1.5">2023-{new Date().toLocaleDateString('en-US', { year: '2-digit' })} ¬© Henry Percy</p>
			</div>
			<div class="text-sm text-stone-400 dark:text-stone-500">
				<p class="flex items-center gap-x-1.5">
					Built with 
					<a class="border-b border-b-stone-200 dark:border-b-stone-800 transition-colors duration-500 hover:border-b-stone-400 hover:dark:border-b-stone-500" href="https://astro.build/" target="_blank">Astro</a>
					<a class="border-b border-b-stone-200 dark:border-b-stone-800 transition-colors duration-500 hover:border-b-stone-400 hover:dark:border-b-stone-500" href="https://www.typescriptlang.org/" target="_blank">TypeScript</a>
					<a class="border-b border-b-stone-200 dark:border-b-stone-800 transition-colors duration-500 hover:border-b-stone-400 hover:dark:border-b-stone-500" href="https://mdxjs.com/" target="_blank">MDX</a>
					<a class="border-b border-b-stone-200 dark:border-b-stone-800 transition-colors duration-500 hover:border-b-stone-400 hover:dark:border-b-stone-500" href="https://tailwindcss.com/" target="_blank">Tailwind</a>
					and <span class="cursor-none hover:scale-125 hover:-rotate-6 transition-all"><span class="absolute"></span>üç∫</span>
				</p>
			</div>
		</div>
	</footer>
</html>

<style is:global>
::selection {
  background-color: #13141026;
  color: #131410;
}

.dark ::selection {
  background-color: #F3F4F126;
  color: #F3F4F1;
}
</style>

<script is:inline>
  function setDarkMode(document) {
		let theme = localStorage.getItem('theme') || 'dark';
		document.documentElement.classList.remove('dark');
		document.documentElement.classList.add(theme);

		const darkThemeIcon = document.getElementById('dark-theme-icon');
		const lightThemeIcon = document.getElementById('light-theme-icon');

		if (theme === 'dark') {
			document.documentElement.setAttribute('data-theme', 'vitesse-dark')
			darkThemeIcon.classList.remove('hidden');
			lightThemeIcon.classList.add('hidden');
		} else {
			document.documentElement.setAttribute('data-theme', 'vitesse-light')
			darkThemeIcon.classList.add('hidden');
			lightThemeIcon.classList.remove('hidden');
		}
  }

  setDarkMode(document);

	function addThemeListeners() {
		const themeToggle = document.getElementById('theme-toggle');
		const darkThemeIcon = document.getElementById('dark-theme-icon');
		const lightThemeIcon = document.getElementById('light-theme-icon');
		const html = document.querySelector('html');
	
		themeToggle.addEventListener('click', () => {
			const theme = html.classList.contains('dark') ? 'light' : 'dark';
			localStorage.setItem('theme', theme);

			html.classList.toggle('dark');
			darkThemeIcon.classList.toggle('hidden');
			lightThemeIcon.classList.toggle('hidden');

			if (theme === 'dark') {
				document.documentElement.setAttribute('data-theme', 'vitesse-dark')
			} else {
				document.documentElement.setAttribute('data-theme', 'vitesse-light')
			}
		});
	}

	document.addEventListener('astro:before-swap', ev => {
    setDarkMode(ev.newDocument);
  });

	document.addEventListener('astro:page-load', () => {
    addThemeListeners();
  });
</script>